@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500;700&family=Space+Grotesk:wght@300;500;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Accessibility: Screen reader only class */
@layer utilities {
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  .not-sr-only {
    position: static;
    width: auto;
    height: auto;
    padding: 0;
    margin: 0;
    overflow: visible;
    clip: auto;
    white-space: normal;
  }
}

@layer base {
  /* Box-sizing for all elements */
  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }
  
  html {
    overflow-x: hidden;
    scroll-behavior: smooth;
    /* All scrolling happens inside <main> for Layout routes */
    -webkit-overflow-scrolling: touch;
    /* Use safe area insets for iOS devices */
    padding-bottom: env(safe-area-inset-bottom, 0);
  }
  
  body {
    overflow-x: hidden;
    /* No overflow-y here - let <main> handle scrolling */
    position: relative;
    /* Prevent layout shifts */
    width: 100%;
    min-height: 100vh;
  }
  
  /* Prevent layout shifts - ensure consistent dimensions */
  #root {
    width: 100%;
    min-height: 100vh;
    position: relative;
  }
  
  /* Ensure pages don't shift */
  [role="main"] {
    width: 100%;
    box-sizing: border-box;
  }
  
  /* Prevent horizontal scrolling on root elements */
  body, html, #root {
    max-width: 100vw;
    overflow-x: hidden;
  }
  
  /* Mobile navigation safe area and touch optimization */
  @media (max-width: 768px) {
    /* Ensure mobile nav respects safe areas and stays at bottom */
    nav[aria-label="Mobile navigation"] {
      padding-bottom: env(safe-area-inset-bottom, 0);
      max-width: 100vw;
      width: 100%;
      position: fixed !important;
      bottom: 0 !important;
      left: 0 !important;
      right: 0 !important;
      z-index: 50 !important;
    }
    
    /* Optimize touch targets for mobile nav */
    nav[aria-label="Mobile navigation"] a,
    nav[aria-label="Mobile navigation"] button {
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      min-width: 44px; /* Minimum touch target size */
      min-height: 44px;
    }
    
    /* Ensure nav items don't overflow on small screens */
    nav[aria-label="Mobile navigation"] > div {
      max-width: 100vw;
      width: 100%;
      overflow-x: hidden;
    }
  }
  
  /* Very small screens - adjust text size */
  @media (max-width: 360px) {
    nav[aria-label="Mobile navigation"] span {
      font-size: 8px !important;
    }
    
    nav[aria-label="Mobile navigation"] svg {
      width: 1.125rem !important;
      height: 1.125rem !important;
    }
  }
  
  * {
    border-color: var(--color-border);
  }
  
  :root {
    /* Light theme - Premium fitness app aesthetic with clean teal accent */
    --color-void: #F9FAFB;           /* Page background - very light, slightly cool */
    --color-surface: #FFFFFF;        /* Cards / containers - pure white */
    --color-panel: #FFFFFF;         /* Card background - pure white */
    --color-border: #E5E7EB;        /* Borders */

    /* Text - Higher contrast for readability */
    --color-text: #111827;          /* Primary text */
    --color-dim: #4B5563;          /* Secondary text - darker for better contrast */
    --color-muted: #6B7280;         /* Muted labels */

    /* Accent - Teal (fresh, modern, distinct from water blue) */
    --color-acid: #14B8A6;          /* Teal - perfect for light theme, doesn't conflict with water */
    --color-on-acid: #FFFFFF;       /* White text on teal accent */
    --color-acid-soft: rgba(20, 184, 166, 0.15);
    --color-acid-softer: rgba(20, 184, 166, 0.08);

    /* Water color - Keep distinct blue for water elements */
    --color-water: #3B82F6;         /* Blue for water - distinct from teal accent */

    /* Icon backgrounds */
    --color-icon-soft: rgba(0, 0, 0, 0.04);

    /* Success / error */
    --color-success: #16a34a;
    --color-error: #dc2626;

    /* Icon + links */
    --color-icon: #111827;
    --color-link: #000000;
    --color-link-hover: #333333;
  }
  
  html {
    /* ensure variables exist on html for Tailwind */
    color-scheme: light;
  }
  
  html.dark,
  .dark {
    /* Dark theme - Premium deep navy aesthetic */
    --color-void: #080A0E;          /* Deep navy background */
    --color-surface: #0E1116;      /* Slightly lighter surface */
    --color-panel: #14181F;        /* Card background */
    --color-border: #23272F;        /* Borders */

    /* Text - Higher contrast for readability */
    --color-text: #F8FAFC;         /* Primary text - brighter white */
    --color-dim: #9CA3AF;          /* Secondary text - more readable gray */
    --color-muted: #6B7280;        /* Muted labels */

    /* Accent - Acid yellow-green */
    --color-acid: #C4FF47;          /* Bright accent */
    --color-on-acid: #080A0E;       /* Text on accent */
    --color-acid-soft: rgba(196, 255, 71, 0.15);
    --color-acid-softer: rgba(196, 255, 71, 0.08);

    /* Icon backgrounds */
    --color-icon-soft: rgba(255, 255, 255, 0.06);

    /* Success / error */
    --color-success: #22c55e;
    --color-error: #f97373;

    /* Icon + links */
    --color-icon: #F5F7FA;
    --color-link: #93c5fd;
    --color-link-hover: #bfdbfe;

    color-scheme: dark;
  }
  
  html {
    transition: background-color 0.3s ease, color 0.3s ease;
  }
  
  body,
  .card-modern,
  .btn-primary,
  .btn-secondary,
  .input-modern {
    transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
  }
  
  body {
    background-color: var(--color-void);
    color: var(--color-text);
    font-weight: 500; /* Increased from 400 for better clarity */
    font-feature-settings: "rlig" 1, "calt" 1;
    background-image: linear-gradient(to right, rgba(148, 163, 184, 0.08) 1px, transparent 1px),
                      linear-gradient(to bottom, rgba(148, 163, 184, 0.08) 1px, transparent 1px);
    background-size: 40px 40px;
    position: relative;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  /* Subtle gradient overlay for light theme premium feel */
  html:not(.dark) body {
    background-image: 
      linear-gradient(to right, rgba(148, 163, 184, 0.08) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(148, 163, 184, 0.08) 1px, transparent 1px);
  }
  
  .dark body {
    background-image: linear-gradient(to right, rgba(148, 163, 184, 0.15) 1px, transparent 1px),
                      linear-gradient(to bottom, rgba(148, 163, 184, 0.15) 1px, transparent 1px);
  }
  
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    opacity: 0.03;
    pointer-events: none;
    z-index: 9999;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
    transition: opacity 0.3s ease;
  }
  
  .dark body::before {
    opacity: 0.03;
  }
}

@layer components {
  /* Light theme cards - clean white with border */
  .card-modern {
    background-color: var(--color-panel);
    color: var(--color-text);
    @apply border rounded-xl p-6 transition-all duration-300;
    background-image: none; /* No gradient in light mode */
    border-width: 1px;
    border-color: rgba(229, 231, 235, 0.7); /* border-border with opacity */
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  }
  
  /* Dark theme cards - keep gradient for depth */
  .dark .card-modern {
    background-image: linear-gradient(180deg,
      rgba(255, 255, 255, 0.04) 0%,
      rgba(0, 0, 0, 0.25) 100%
    );
    box-shadow: 0 18px 45px rgba(15, 23, 42, 0.75);
    border-color: rgba(35, 39, 47, 0.6); /* border-border with opacity */
  }
  
  .card-modern:hover {
    border-color: var(--color-dim);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  }
  
  .dark .card-modern:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  }
  
  .btn-primary {
    background-color: var(--color-acid);
    color: var(--color-on-acid);
    border: 1px solid var(--color-acid);
    @apply px-6 py-3 font-bold text-xs uppercase tracking-wider rounded-sm transition-all duration-300;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
  }
  
  .btn-primary:hover {
    filter: brightness(1.05);
    box-shadow: 0 0 20px var(--color-acid-soft);
  }
  
  .btn-secondary {
    border-color: var(--color-border);
    background-color: transparent;
    color: var(--color-text);
    @apply px-6 py-3 border font-bold text-xs uppercase tracking-wider rounded-sm transition-all duration-300;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
  }
  
  .btn-secondary:hover {
    border-color: var(--color-dim);
    background-color: var(--color-panel);
  }
  
  .input-modern {
    background-color: var(--color-surface);
    border-color: var(--color-border);
    color: var(--color-text);
    @apply w-full border-b px-4 py-3 transition-colors;
  }
  
  .input-modern::placeholder {
    color: var(--color-dim);
  }
  
  .input-modern:focus {
    outline: none;
    border-color: var(--color-acid);
  }
  
  .section-header {
    border-color: var(--color-border);
    background-color: var(--color-panel);
    color: var(--color-acid);
    @apply font-mono text-xs uppercase tracking-widest mb-6 px-4 py-2 border;
  }
  
  .accent-strip {
    @apply flex items-center gap-2;
  }
  
  .accent-strip::before {
    content: '';
    height: 2px;
    width: 2rem;
    background-color: var(--color-acid);
  }
  
  .accent-strip::after {
    content: '';
    height: 2px;
    width: 0.75rem;
    background-color: var(--color-acid);
    opacity: 0.5;
  }
  
  .icon-base {
    @apply fill-none stroke-current stroke-2;
    stroke-linecap: round;
    stroke-linejoin: round;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  svg {
    color: var(--color-icon);
    stroke: currentColor;
  }
  
  nav svg {
    color: var(--color-dim);
  }
  
  nav a:hover svg,
  nav button:hover svg {
    color: var(--color-text);
  }
  
  .text-success svg,
  svg.text-success {
    color: var(--color-success);
    stroke: currentColor;
  }
  
  .text-error svg,
  svg.text-error {
    color: var(--color-error);
    stroke: currentColor;
  }
}

@layer utilities {
  .text-gradient {
    @apply bg-gradient-to-b from-white to-muted bg-clip-text text-transparent;
  }
  
  .glow-acid {
    box-shadow: 0 0 20px var(--color-acid-soft);
  }
  
  .glow-white {
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.08);
  }

  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
  
  /* Utility classes for theme-aware colors */
  /* These are now available via Tailwind classes (bg-acid, text-acid, etc.) */
  /* but keeping here for backwards compatibility and explicit control */
  
  .bg-acid {
    background-color: var(--color-acid);
  }
  
  .bg-acid-soft {
    background-color: var(--color-acid-soft);
  }
  
  .bg-acid-softer {
    background-color: var(--color-acid-softer);
  }
  
  .border-acid {
    border-color: var(--color-acid);
  }
  
  .text-acid {
    color: var(--color-acid);
    font-weight: 600; /* Make green text bolder by default for better visibility */
  }
  
  .text-dim {
    color: var(--color-dim);
  }
  
  .text-muted {
    color: var(--color-muted);
  }
  
  .text-text {
    color: var(--color-text);
  }
  
  .text-icon {
    color: var(--color-icon);
  }
  
  .text-link {
    color: var(--color-link);
  }
  
  .text-link-hover:hover {
    color: var(--color-link-hover);
  }
  
  a:not(.btn-primary):not(footer a) {
    color: var(--color-link);
  }
  
  a:not(.btn-primary):not(footer a):hover {
    color: var(--color-link-hover);
  }
  
  /* Footer links should be blue in both themes */
  footer a:not(.btn-primary) {
    color: rgb(59 130 246) !important; /* blue-500 */
  }
  
  footer a:not(.btn-primary):hover {
    color: rgb(37 99 235) !important; /* blue-600 */
  }
  
  html.dark footer a:not(.btn-primary) {
    color: rgb(96 165 250) !important; /* blue-400 */
  }
  
  html.dark footer a:not(.btn-primary):hover {
    color: rgb(147 197 253) !important; /* blue-300 */
  }
  
  /* Light mode: make sure text isn't washed out */
  html:not(.dark) .text-text {
    color: var(--color-text) !important;
  }

  html:not(.dark) .text-dim {
    color: var(--color-dim) !important;
  }
  
  html:not(.dark) .text-muted {
    color: var(--color-muted) !important;
  }

  /* Light mode: icons should be solid and visible */
  html:not(.dark) svg {
    color: var(--color-icon) !important;
    stroke: currentColor !important;
    opacity: 1 !important;
  }

  /* If you have nav icons that looked faint */
  html:not(.dark) nav svg {
    color: var(--color-dim) !important;
  }

  html:not(.dark) nav a:hover svg,
  html:not(.dark) nav button:hover svg {
    color: var(--color-text) !important;
  }
  
  /* Light theme: Use soft black tint for backgrounds instead of solid black */
  /* This provides better contrast and a cleaner minimal look */
  html:not(.dark) .bg-acid {
    background-color: var(--color-acid-soft) !important;
  }
  
  /* Icon containers with acid background should use soft tint in light theme */
  html:not(.dark) [class*="bg-acid/20"],
  html:not(.dark) .bg-acid\/20 {
    background-color: var(--color-acid-soft) !important;
  }
  
  /* Ensure acid text/icons remain visible on soft backgrounds */
  html:not(.dark) .bg-acid-soft .text-acid,
  html:not(.dark) .bg-acid-soft svg.text-acid,
  html:not(.dark) [class*="bg-acid-soft"] .text-acid {
    color: var(--color-acid) !important;
    stroke: currentColor !important;
  }
  
  /* Hover states for soft acid backgrounds */
  html:not(.dark) .bg-acid-soft:hover {
    background-color: var(--color-acid-softer) !important;
  }
  
  /* Light theme: Primary buttons should be solid black with white text */
  html:not(.dark) .btn-primary {
    background-color: var(--color-acid) !important;
    color: var(--color-on-acid) !important;
    border-color: var(--color-acid) !important;
  }
  
  /* Ensure icons and text inside primary buttons are white in light theme */
  html:not(.dark) .btn-primary svg,
  html:not(.dark) .btn-primary span,
  html:not(.dark) .btn-primary {
    color: var(--color-on-acid) !important;
  }
  
  html:not(.dark) .btn-primary:hover {
    background-color: #1a1a1a !important;
    border-color: #1a1a1a !important;
    filter: none !important;
    box-shadow: 0 0 0 0 !important;
  }
  
  html:not(.dark) .btn-primary:hover svg,
  html:not(.dark) .btn-primary:hover span {
    color: var(--color-on-acid) !important;
  }
  
  /* Light theme: Section headers should use black text */
  html:not(.dark) .section-header {
    color: var(--color-acid) !important;
  }
  
  /* Light theme: Active navigation links should use black */
  html:not(.dark) nav a.text-acid,
  html:not(.dark) nav .text-acid {
    color: var(--color-acid) !important;
  }
  
  /* Light theme: Force all text-acid to be brighter green and bold */
  html:not(.dark) .text-acid,
  html:not(.dark) [class*="text-acid"] {
    color: var(--color-acid) !important;
    font-weight: 600 !important; /* Make green text bolder for visibility */
  }
  
  /* Light theme: Force all acid-colored icons to be black */
  html:not(.dark) svg.text-acid,
  html:not(.dark) .text-acid svg {
    color: var(--color-acid) !important;
    stroke: var(--color-acid) !important;
  }
  
  /* Light theme: Remove any lime/green colors */
  html:not(.dark) .text-lime,
  html:not(.dark) .bg-lime,
  html:not(.dark) [class*="text-lime"],
  html:not(.dark) [class*="bg-lime"] {
    color: var(--color-acid) !important;
    background-color: var(--color-acid-soft) !important;
  }
  
  /* Light theme: Progress bars and sliders should use black */
  html:not(.dark) [style*="background-color: #ccff00"],
  html:not(.dark) [style*="background-color:#ccff00"],
  html:not(.dark) [style*="background-color: #7aa300"],
  html:not(.dark) [style*="background-color:#7aa300"] {
    background-color: var(--color-acid) !important;
  }
  
  /* Light theme: Gradient backgrounds should use black */
  html:not(.dark) [class*="from-acid"],
  html:not(.dark) [class*="to-lime"] {
    --tw-gradient-from: var(--color-acid) !important;
    --tw-gradient-to: var(--color-acid) !important;
  }
  
  /* Fix dialog positioning to prevent shaking/moving */
  [role="dialog"] {
    position: fixed !important;
    left: 50% !important;
    top: 50% !important;
    transform: translate(-50%, -50%) !important;
    will-change: auto !important;
  }
  
  /* Prevent layout shifts in dialog content */
  [data-radix-dialog-content] {
    contain: layout style paint;
    backface-visibility: hidden;
    transform: translate(-50%, -50%) !important;
  }
}
